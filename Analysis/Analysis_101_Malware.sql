/*
Examine Malware details
*/
DECLARE 
@ACTION			INT = 0
					|256		--> Objects per year with [@objTypeId] - Was the object used during the year [Y|N]
					--|512		--> Malware useage [Counts] by year, with [@top]
					--|1024		--> Malware, use of techniques, with [@top]
					--|2048		--> Store/View most used {Malware|Tools}, with [three [mu*] variables below]
					
					--| 128		--> EXEC [usp_Mitre_RunAnalysis] to repopulate ALL of {[aMostUsedObjects], [aMalwareAndTools_AnnualAnalysis], [AnnualRelations]}
,
@objTypeId		INT = 2,			--> With [@ACTION = 256]  [SELECT * FROM mkType]; 1:Technique, 2:CoA, 4:Group, 5:Malware, 8:Tool, 11:Sub-Technique
@top			INT = 30,			--> Display the TOP(@top) rows

@muComboPk		INT = 1,			--> Pk from [aMostUsedCombinations] to seed most-used SAVE/SELECT [SELECT * FROM dbo.aMostUsedCombinations c]
@muDoUpdate		BIT = 0,			--> Update [aMostUsedObjects] 
@muTop			INT = 0				--> Non-zero value overrides the [Top] value of the specified search



EXEC dbo.[usp_Mitre_Analysis_101_Malware] 
	@ACTION		= @ACTION,			--> 
	@objTypeId	= @objTypeId,		--> With [@ACTION = 256]  [SELECT * FROM mkType]; 1:Technique, 2:CoA, 4:Group, 5:Malware, 8:Tool, 11:Sub-Technique
	@top		= @top,				--> Display the TOP(@top) rows
	@muComboPk	= @muComboPk,		--> Pk from [aMostUsedCombinations] to seed most-used SAVE/SELECT [SELECT * FROM dbo.aMostUsedCombinations c]
	@muDoUpdate	= @muDoUpdate,		--> Update [aMostUsedObjects] 
	@muTop		= @muTop			--> 